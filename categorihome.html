<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Galai - Best Honey in Your City</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <link href="img/favicon.ico" rel="icon">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <div class="container wow fadeInUp" data-wow-delay="0.1s">
        <div class="row" id="image">
            <div><img width="100%" height="auto" src="img/Dans le passé, le présent et le futur, GALAI MIEL vous offre les meilleurs types/2.png" alt=""></div>
        </div>
    </div>

    <div class="container wow fadeInUp" data-wow-delay="0.1s" id="categories-container" style="height: 150px;">
        <!-- Dynamic content will be injected here -->
    </div>

    <!-- Include Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            axios.get('http://localhost:8088/categorie/getAll/prodsWithThumb')
                .then(response => {
                    // console.log(response.data); 

                    const categories = response.data; 
                    if (Array.isArray(categories)) {
                        const categoriesContainer = document.getElementById('categories-container');

                        categories.forEach(category => {
                            const categoryDiv = document.createElement('div');
                            categoryDiv.classList.add('row', 'category-container');
                            
                            const categoryImageDiv = document.createElement('div');
                            categoryImageDiv.classList.add('productsImg', 'col-sm-3');
                            categoryImageDiv.innerHTML = `<img src="data:image/jpeg;base64,${category.photo}" alt="${category.nom}">`;
                            categoryDiv.appendChild(categoryImageDiv);

                            const productsContainer = document.createElement('div');
                            productsContainer.classList.add('col-sm-9', 'row', 'ml');
                            
                            const chevronLeftDiv = document.createElement('div');
                            chevronLeftDiv.classList.add('chevronLeft', 'col-sm-1');
                            chevronLeftDiv.innerHTML = `<i class="bi bi-chevron-left"></i>`;
                            productsContainer.appendChild(chevronLeftDiv);

                            const productsWrapper = document.createElement('div');
                            productsWrapper.classList.add('products', 'table-responsive', 'col-sm-10');
                            
                            category.produits.forEach(produit => {
                                const productHtml = `
                                <div class="product-item-w" style="margin-bottom: 0;">
                                    <div class="prodImage" style="margin-bottom: 0;">
                                        <img src="data:image/jpeg;base64,${produit.thumbnail}" class="pI" alt="${produit.nom}" style="width: 100%; height: auto;">
                                    </div>
                                    <div class="prodDetails" style="margin-top: 0; padding-top: 0;">
                                        <div class="name" dir="rtl">${produit.nom}</div>
                                        <div class="price" dir="rtl">ابتداء من <span class="lastPrice">${produit.prixList[0].prix} دينار</span><span class="newPrice">${produit.prixList[0].prix - produit.prixList[0].remise} دينار</span></div>
                                        <div class="quantite">
                                            ${produit.prixList.map(prix => `<div class="grammage">${prix.grammage}g</div>`).join('')}
                                        </div>
                                    </div>
                                </div>`;
                                productsWrapper.innerHTML += productHtml;
                            });

                            productsContainer.appendChild(productsWrapper);

                            const chevronRightDiv = document.createElement('div');
                            chevronRightDiv.classList.add('chevronRight', 'col-sm-1');
                            chevronRightDiv.innerHTML = `<i class="bi bi-chevron-right"></i>`;
                            productsContainer.appendChild(chevronRightDiv);

                            categoryDiv.appendChild(productsContainer);
                            categoriesContainer.appendChild(categoryDiv);
                        });
                    } else {
                        console.error('Expected an array of categories but got:', categories);
                    }
                })
                .catch(error => console.error('Error fetching data:', error));
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>
