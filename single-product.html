<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Galai - Galai Website Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet"> 

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <style>
        .btn-shadow {
            box-shadow: 0 4px 8px #0c0c0c;
            border: 1px solid #151515; 
        }
    </style>
  
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" role="status"></div>
    </div>
    <!-- Spinner End -->

    <!-- Topbar Start -->
    <div class="container-fluid top-bar bg-dark text-light px-0 wow fadeIn" data-wow-delay="0.1s">
        <div class="row gx-0 align-items-center d-none d-lg-flex">
            <div class="col-lg-6 px-5 text-start">
                <div class="h-100 d-inline-flex align-items-center">
                    <p class="text-light fs-7 mb-0 me-2" style="font-size: 15px;">
                        <i class="bi bi-telephone" style="color:#EAA636;"></i>&nbsp;&nbsp;(+216) 55 716 454
                    </p>
                    
                    <a class="btn-sm border-start rounded-0" style="color:white;" href="mailto:info@example.com">
                        <i class="bi bi-envelope" style="color:#EAA636;"></i>&nbsp;&nbsp;info@example.com
                    </a>
                </div>
            </div>
            
            <div class="col-lg-6 px-5 text-end">
                <div class="h-100 d-inline-flex align-items-center">
                    <a class="btn-lg-square border-end rounded-0" href="https://facebook.com"><i class="fab fa-facebook-f" style="color:white;"></i></a>
                    <a class="btn-lg-square border-end rounded-0" href="https://twitter.com"><i class="fab fa-twitter" style="color:white;"></i></a>
                    <a class="btn-lg-square border-end rounded-0" href="https://linkedin.com"><i class="fab fa-linkedin-in" style="color:white;"></i></a>
                    <a class="btn-lg-square pe-0" href="https://instagram.com"><i class="fab fa-instagram" style="color:white;"></i></a>
                </div>
            </div>
        </div>
    </div>
    <!-- Topbar End -->

    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top py-lg-0 px-lg-5 wow fadeIn" data-wow-delay="0.1s">
        <a href="index.html" class="navbar-brand ms-4 ms-lg-0">
            <h1 class="text-primary m-0"><img style="height: 60px;" src="img/logoPng1.png" alt="Galai Logo"></h1>
        </a>
        <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav mx-auto p-4 p-lg-0">
                <a href="index.html" class="nav-item nav-link active">الصفحة الرئيسية</a>
                <a href="about.html" class="nav-item nav-link">معلومات عنا</a>
                <a href="service.html" class="nav-item nav-link">خدماتنا</a>
                <a href="product.html" class="nav-item nav-link">منتجاتاتنا</a>
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">صفحاتنا</a>
                    <div class="dropdown-menu m-0">
                        <a href="team.html" class="dropdown-item">فريقنا</a>
                        <a href="testimonial.html" class="dropdown-item">Testimonial</a>
                        <a href="404.html" class="dropdown-item">404 Page</a>
                    </div>
                </div>
                <a href="contact.html" class="nav-item nav-link">تواصل معنا</a>
            </div>
        </div>
        <div>
            <a href="panier.html"><i class="bi bi-basket2-fill b1"></i></a>
            <span class="qtt">1</span>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- Page Header Start -->
    <div class="container-fluid page-header py-6 wow fadeIn" data-wow-delay="0.1s">
        <div class="container text-center pt-5 pb-3">
            <h1 class="display-4 text-white animated slideInDown mb-3" id="product-name">Nom de Produit</h1>
            <nav aria-label="breadcrumb animated slideInDown">
                <ol class="breadcrumb justify-content-center mb-0">
                    <li class="breadcrumb-item"><a class="text-white" href="index.html">Home</a></li>
                    <li class="breadcrumb-item"><a class="text-white" href="product.html">Products</a></li>
                    <li class="breadcrumb-item text-primary active" aria-current="page" id="product-name-breadcrumb">Nom de Produit</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- Page Header End -->

    <!--Détail produit start-->
    <div class="container product-container">
        <div class="row">
            <div class="col-lg-6 d-flex flex-column flex-lg-row">
                <div id="thumbnailContainer" class="d-flex flex-column mb-3 mb-lg-0">
                </div>
                <div style="width: 25px;"></div>
                <div class="d-flex justify-content-center align-items-center h-100 flex-grow-1">
                    <img id="mainImage" class="img-fluid rounded product-image" src="img/product-1.jpg" alt="Nom de Produit">
                </div>
            </div>

            <div class="col-md-6">
                <h2 id="product-name-detail">Nom de Produit</h2>
                <p class="product-price">À partir de <span id="min-product-price" style="font-size: large; font-weight: bold;">48.000 DT</span></p>
                <p><i><strong>Description :</strong></i></p>
                Le <strong id="nom-produit">Nom de Produit</strong> <span id="product-description"> est un véritable trésor de la nature, récolté à partir des nectars variés des fleurs sauvages qui poussent dans les prairies et les forêts. Sa saveur unique et délicate, légèrement florale, en fait un choix idéal pour les amateurs de miel à la recherche d'un goût authentique et naturel.
                </span>
           
                <div class="card-body">
                    <p style="color:black;font-size: medium;"><strong>POIDS <span id="weightSpan"></span></strong></p>
                    <p style="color: black; font-size: medium;" id="priceSR"> À <span id="product-price" style="color: black;font-weight: bold;"></span></p>
                    <p style="color: black; font-size: medium;" id="priceWR">Prix: De <span id="product-price-sans-remise" style="color: grey; text-decoration: line-through;">450</span> à <span id="product-price-remise" style="color: black;font-weight: bold;">350</span></p>
                    <div id="weightPriceContainer" class="d-flex flex-wrap">
                        <!-- Les options de poids et prix seront insérées ici -->
                    </div>
                </div>
    
                <p><i><strong>Quantité :</strong></i></p>
                <div class="input-group quantity-control mx-2" style="width: 90px;display: inline-flex;">
                    <button class="btn btn-sm btn-primary btn-minus"><i class="fa fa-minus"></i></button>
                    <input class="form-control border-0 text-center" id="quantityInput" type="text" value="1">
                    <button class="btn btn-sm btn-primary btn-plus"><i class="fa fa-plus"></i></button>
                </div>          
                <button style="width: 300px;height: 40px; background-color: #EAA636;" class="btn">Ajouter Au Panier</button>

            </div>
        </div>
    </div>
    <!--Détail produit end-->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-light footer my-6 mb-0 py-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-light mb-4">Office Address</h4>
                    <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>123 Street, New York, USA</p>
                    <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>+012 345 67890</p>
                    <p class="mb-2"><i class="fa fa-envelope me-3"></i>info@example.com</p>
                    <div class="d-flex pt-2">
                        <a class="btn btn-square btn-outline-light rounded-circle me-1" href="https://twitter.com"><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-1" href="https://facebook.com"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-1" href="https://youtube.com"><i class="fab fa-youtube"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-0" href="https://linkedin.com"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-light mb-4">Quick Links</h4>
                    <a class="btn btn-link" href="about.html">About Us</a>
                    <a class="btn btn-link" href="contact.html">Contact Us</a>
                    <a class="btn btn-link" href="service.html">Our Services</a>
                    <a class="btn btn-link" href="terms.html">Terms & Condition</a>
                    <a class="btn btn-link" href="support.html">Support</a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-light mb-4">Photo Gallery</h4>
                    <div class="row g-2">
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-1.jpg" alt="Product Image 1">
                        </div>
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-2.jpg" alt="Product Image 2">
                        </div>
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-3.jpg" alt="Product Image 3">
                        </div>
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-2.jpg" alt="Product Image 4">
                        </div>
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-3.jpg" alt="Product Image 5">
                        </div>
                        <div class="col-4">
                            <img class="img-fluid bg-light rounded p-1" src="img/product-1.jpg" alt="Product Image 6">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Copyright Start -->
    <div class="container-fluid copyright text-light py-4 wow fadeIn" data-wow-delay="0.1s">
        <div class="container">
            <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                &copy;2023 – <a href="#">Miel Galai</a>, Tous droits réservés.
            </div> 
        </div>
    </div>
    <!-- Copyright End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"></script>

    <script>
       document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('productId');
        const weightSpan = document.getElementById('weightSpan');
        const thumbnailContainer = document.getElementById('thumbnailContainer');
        const weightPriceContainer = document.getElementById('weightPriceContainer');
        const productPrice = document.getElementById('product-price');
        const minProductPrice = document.getElementById('min-product-price');
        const productPriceSansRemise = document.getElementById('product-price-sans-remise');
        const productPriceRemise = document.getElementById('product-price-remise');
        const priceSR = document.getElementById('priceSR');
        const priceWR = document.getElementById('priceWR');
        let selectedButton = null; 

        axios.get(`http://localhost:8088/produit/getById/withoutCategorie/${productId}`)
            .then(response => {
                const product = response.data;
                console.log('Product Data:', product);

                // Update product details
                document.getElementById('product-name').textContent = product.nom;
                document.getElementById('product-description').textContent = product.description;
                document.getElementById('product-name-breadcrumb').textContent = product.nom;
                document.getElementById('product-name-detail').textContent = product.nom;
                document.getElementById('nom-produit').textContent = product.nom;
                document.getElementById('mainImage').src = `data:image/jpeg;base64,${product.thumbnail}`;
                const images = product.photos;
                weightPriceContainer.innerHTML = '';

                let minPrice = Number.POSITIVE_INFINITY;
                let minPriceGrammage = '';
                let minPriceObject = null; 

                product.prixList.forEach(prix => {
                    const prixAvantRemise = prix.prix;
                    const prixApresRemise = prixAvantRemise - (prixAvantRemise * prix.remise / 100.0);

                    // Update minimum price
                    if (prixApresRemise < minPrice) {
                        minPrice = prixApresRemise;
                        minPriceGrammage = prix.grammage;
                        minPriceObject = prix; 
                    }

                    // Create and add button for each grammage
                    const button = document.createElement('button');
                    button.classList.add('btn', 'btn-outline-dark', 'btn-sm', 'm-1');
                    button.textContent = `${prix.grammage}g`;

                    button.addEventListener('click', () => {
                        updatePriceDisplay(prixAvantRemise, prixApresRemise, prix.remise, prix.grammage, button);
                    });

                    weightPriceContainer.appendChild(button);
                });

                // Update minimum prices and select the corresponding button
                minProductPrice.textContent = `${minPrice} DT`;
                productPrice.textContent = `${minPrice} DT`;
                weightSpan.textContent = minPriceGrammage;

                // Automatically select the button for the minimum price
                const buttons = weightPriceContainer.getElementsByTagName('button');
                for (let button of buttons) {
                    if (button.textContent === `${minPriceGrammage}g`) {
                        button.classList.add('btn-shadow');
                        selectedButton = button;
                        updatePriceDisplay(minPriceObject.prix, minPrice, minPriceObject.remise, minPriceGrammage, button);
                        break;
                    }
                }

                function createThumbnail(src) {
                    const img = document.createElement('img');
                    img.src = `data:image/jpeg;base64,${src}`;
                    img.style.width = '100px'; 
                    img.style.height = 'auto';
                    img.style.cursor = 'pointer';
                    img.classList.add('thumbnail');
                    img.addEventListener('click', function() {
                        mainImage.src = `data:image/jpeg;base64,${src}`;
                    });
                    return img;
                }

                images.forEach(function(src) {
                    const thumbnail = createThumbnail(src);
                    thumbnailContainer.appendChild(thumbnail);
                });

            })
            .catch(error => {
                console.error('Error retrieving product details:', error);
            });

        function updatePriceDisplay(prixAvantRemise, prixApresRemise, remise, grammage, button) {
            if (selectedButton) {
                selectedButton.classList.remove('btn-shadow');
            }
            button.classList.add('btn-shadow');
            selectedButton = button; 

            // Update price display based on remise
            if (remise > 0) {
                productPriceSansRemise.textContent = `${prixAvantRemise} DT`;
                productPriceRemise.textContent = `${prixApresRemise} DT`;
                priceSR.style.display = 'none'; 
                priceWR.style.display = 'block';
            } else {
                productPriceSansRemise.textContent = '';
                productPriceRemise.textContent = '';
                priceSR.style.display = 'block';
                priceWR.style.display = 'none'; 
            }
            productPrice.textContent = `${prixApresRemise} DT`;
            weightSpan.textContent = grammage;
        }
});
    </script>
    <script>
            document.querySelector('.btn-minus').addEventListener('click', function() {
                let quantityInput = document.getElementById('quantityInput');
                let currentValue = parseInt(quantityInput.value);
                if (currentValue > 1) {
                    quantityInput.value = currentValue - 1;
                }
            });

            document.querySelector('.btn-plus').addEventListener('click', function() {
                let quantityInput = document.getElementById('quantityInput');
                quantityInput.value = parseInt(quantityInput.value) + 1;
            });
    </script>
    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>
